(window.webpackJsonp=window.webpackJsonp||[]).push([[75,69],{"013z":function(e,t,n){"use strict";var a=n("q1tI"),o=n.n(a),r=n("NmYn"),c=n.n(r),l=n("Wbzz"),i=n("Xrax"),s=n("k4MR"),b=n("TSYQ"),p=n.n(b),u=n("QH2O"),d=n.n(u),m=n("qKvR"),h=function(e){var t,n=e.title,a=e.theme,o=e.tabs,r=void 0===o?[]:o;return Object(m.b)("div",{className:p()(d.a.pageHeader,(t={},t[d.a.withTabs]=r.length,t[d.a.darkMode]="dark"===a,t))},Object(m.b)("div",{className:"bx--grid"},Object(m.b)("div",{className:"bx--row"},Object(m.b)("div",{className:"bx--col-lg-12"},Object(m.b)("h1",{id:"page-title",className:d.a.text},n)))))},O=n("BAC9"),g=function(e){var t=e.relativePagePath,n=e.repository,a=Object(l.useStaticQuery)("1364590287").site.siteMetadata.repository,o=n||a,r=o.baseUrl,c=o.subDirectory,i=r+"/edit/"+o.branch+c+"/src/pages"+t;return r?Object(m.b)("div",{className:"bx--row "+O.row},Object(m.b)("div",{className:"bx--col"},Object(m.b)("a",{className:O.link,href:i},"Edit this page on GitHub"))):null},j=n("FCXl"),f=n("dI71"),x=n("I8xM"),w=function(e){function t(){return e.apply(this,arguments)||this}return Object(f.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.tabs,a=e.slug,o=a.split("/").filter(Boolean).slice(-1)[0],r=n.map((function(e){var t,n=c()(e,{lower:!0,strict:!0}),r=n===o,i=new RegExp(o+"/?(#.*)?$"),s=a.replace(i,n);return Object(m.b)("li",{key:e,className:p()((t={},t[x.selectedItem]=r,t),x.listItem)},Object(m.b)(l.Link,{className:x.link,to:""+s},e))}));return Object(m.b)("div",{className:x.tabsContainer},Object(m.b)("div",{className:"bx--grid"},Object(m.b)("div",{className:"bx--row"},Object(m.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(m.b)("nav",{"aria-label":t},Object(m.b)("ul",{className:x.list},r))))))},t}(o.a.Component),v=n("MjG9"),k=n("CzIb"),N=n("Asxa"),y=n("OIbQ"),C=n.n(y),P=function(e){var t=e.date,n=new Date(t);return t?Object(m.b)(N.c,{className:C.a.row},Object(m.b)(N.a,null,Object(m.b)("div",{className:C.a.text},"Page last updated: ",n.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};t.a=function(e){var t=e.pageContext,n=e.children,a=e.location,o=e.Title,r=t.frontmatter,b=void 0===r?{}:r,p=t.relativePagePath,u=t.titleType,d=b.tabs,O=b.title,f=b.theme,x=b.description,N=b.keywords,y=b.date,C=Object(k.a)().interiorTheme,I=Object(l.useStaticQuery)("2456312558").site.pathPrefix,T=I?a.pathname.replace(I,""):a.pathname,A=d?T.split("/").filter(Boolean).slice(-1)[0]||c()(d[0],{lower:!0}):"",S=f||C;return Object(m.b)(s.a,{tabs:d,homepage:!1,theme:S,pageTitle:O,pageDescription:x,pageKeywords:N,titleType:u},Object(m.b)(h,{title:o?Object(m.b)(o,null):O,label:"label",tabs:d,theme:S}),d&&Object(m.b)(w,{title:O,slug:T,tabs:d,currentTab:A}),Object(m.b)(v.a,{padded:!0},n,Object(m.b)(g,{relativePagePath:p}),Object(m.b)(P,{date:y})),Object(m.b)(j.a,{pageContext:t,location:a,slug:T,tabs:d,currentTab:A}),Object(m.b)(i.a,null))}},"5Cs4":function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return i})),n.d(t,"default",(function(){return u}));var a,o=n("wx14"),r=n("zLVn"),c=(n("q1tI"),n("7ljp")),l=n("013z"),i=(n("T0C+"),n("qKvR"),{}),s=(a="PageDescription",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),Object(c.b)("div",e)}),b={_frontmatter:i},p=l.a;function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(c.b)(p,Object(o.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)(s,{mdxType:"PageDescription"}),Object(c.b)("h2",null,"The following steps provide a fast path to manually complete the installation based on information from ",Object(c.b)("a",{parentName:"h2",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-portworx"},"Storing data with Portworx")),Object(c.b)("p",null,"Ensure you have access to an OpenShift cluster with the correct size and number of workers. Portworx requires workers that are at least 16cpu/64GB."),Object(c.b)("p",null,"For reference, full documentation on how to provision an OpenShift cluster is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-getting-started#clusters_gs"},"here"),"."),Object(c.b)("h2",null,"1. Log in to IBM Cloud CLI"),Object(c.b)("p",null,"From a terminal window, log in to IBM Cloud using the ",Object(c.b)("a",{parentName:"p",href:"https://www.ibm.com/cloud/cli"},"cli")," and set the target ",Object(c.b)("inlineCode",{parentName:"p"},"resource_group")," to the group with your target OpenShift cluster."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud login -sso\nibmcloud target -r us-south -g <resource_group>\nibmcloud oc clusters\nibmcloud oc cluster config -c <cluster_name> –-admin\n")),Object(c.b)("h2",null,"2. Provision and Attach Block Storage"),Object(c.b)("p",null,Object(c.b)("a",{parentName:"p",href:"#classic-infrastructure"},"Classic Infrastructure clusters")),Object(c.b)("p",null,Object(c.b)("a",{parentName:"p",href:"#vpc"},"VPC clusters")),Object(c.b)("h3",null,"Classic Infrastructure"),Object(c.b)("h4",null,"Provision classic block storage"),Object(c.b)("p",null,"For reference, full documentation on manually provisioning Block Storage is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/containers?topic=containers-utilities#manual_block"},"here"),"."),Object(c.b)("p",null,"Issue this command for each of the workers:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block volume-order --storage-type endurance --size <size> --tier 10 --os-type LINUX -d <datacenter>\n")),Object(c.b)("p",null,"Get block volume details:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block volume-list\n")),Object(c.b)("p",null,"Get worker details:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud oc workers --cluster $CLUSTER\n")),Object(c.b)("p",null,"For each worker, authorize the block storage:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block access-authorize <volume_id> -p <node_private_ip>\n")),Object(c.b)("p",null,"For example:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block access-authorize 214099980 -p 10.185.227.240\nibmcloud sl block access-authorize 214100004 -p 10.185.227.238\nibmcloud sl block access-authorize 214100042 -p 10.185.227.242\nibmcloud sl block access-authorize 214100076 -p 10.185.227.248\n")),Object(c.b)("h4",null,"Attach storage to classic worker nodes"),Object(c.b)("p",null,"a. Install or migrate to Helm version 3 on cluster"),Object(c.b)("p",null,"For reference, instructions to install Helm v3 are ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-helm#install_v3"},"here"),"."),Object(c.b)("p",null,"b. Install IBM Cloud Block Storage Attacher Plug-in"),Object(c.b)("p",null,"For reference, full documentation on IBM Cloud Block Storage Attacher Plug-in is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-utilities#block_storage_attacher"},"here"),"."),Object(c.b)("p",null,"Issue these commands:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"oc project kube-system\nhelm repo update\nhelm install block-attacher iks-charts/ibm-block-storage-attacher\noc get pod -n kube-system -o wide | grep attacher\noc get storageclasses | grep attacher\n")),Object(c.b)("p",null,"c. Attach newly created block storage to worker nodes"),Object(c.b)("p",null,"For reference, full documentation on how to attach raw block storage to worker nodes is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-utilities#attach_block"},"here"),"."),Object(c.b)("p",null,"List storage volumes"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block volume-list\n")),Object(c.b)("p",null,"Issue these two commands for each storage volume to get necessary information to create PVs below:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud sl block access-list <volume_id>\nibmcloud sl block volume-detail <volume_id>\n")),Object(c.b)("p",null,"Create a PV to attach each storage block to a worker:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'cat <<EOF | oc create -f -\napiVersion: v1\nkind: PersistentVolume\nmetadata:\nname: <pv_name>\nannotations:\n  ibm.io/iqn: "<IQN_hostname>"\n  ibm.io/username: "<username>"\n  ibm.io/password: "<password>"\n  ibm.io/targetip: "<targetIP>"\n  ibm.io/lunid: "<lunID>"\n  ibm.io/nodeip: "<private_worker_IP>"\n  ibm.io/volID: "<volume_ID>"\nspec:\ncapacity:\n  storage: <size>\naccessModes:\n  - ReadWriteOnce\nhostPath:\n  path: /\nstorageClassName: ibmc-block-attacher\nEOF\n')),Object(c.b)("p",null,"For example:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'cat <<EOF | oc create -f -\napiVersion: v1\nkind: PersistentVolume\nmetadata:\nname: px-pv-240\nannotations:\n  ibm.io/iqn: "iqn.2021-02.com.ibm:ibm02su2270065-i168011233"\n  ibm.io/username: "IBM02SU2270065-I168011233"\n  ibm.io/password: "xxxxxxxxxxxxx"\n  ibm.io/targetip: "161.26.110.196"\n  ibm.io/lunid: "0"\n  ibm.io/nodeip: "10.185.227.240"\n  ibm.io/volID: "214099980"\nspec:\ncapacity:\n  storage: 600Gi\naccessModes:\n  - ReadWriteOnce\nhostPath:\n  path: /\nstorageClassName: ibmc-block-attacher\nEOF\n')),Object(c.b)("p",null,"To list and describe pv:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"oc get pv\noc describe pv <pv_name>\n")),Object(c.b)("p",null,"If attached correctly, you will see ",Object(c.b)("inlineCode",{parentName:"p"},"ibm.io/attachstatus: attached")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"Name:            px-pv-238\nLabels:          <none>\nAnnotations:     ibm.io/attachstatus: attached\n                 ibm.io/dm: /dev/dm-1\n                 ibm.io/iqn: iqn.2021-02.com.ibm:ibm02su2270065-i168011229\n                 ibm.io/lunid: 1\n                 ibm.io/mpath: 3600a09803830566f4724516532536b52\n                 ibm.io/nodeip: 10.185.227.238\n                 ibm.io/password: eRdwGTYSBbCZh444\n                 ibm.io/targetip: 161.26.110.204\n                 ibm.io/username: IBM02SU2270065-I168011229\n                 ibm.io/volID: 214100004\nFinalizers:      [kubernetes.io/pv-protection]\nStorageClass:    ibmc-block-attacher\nStatus:          Available\nClaim:           \nReclaim Policy:  Retain\nAccess Modes:    RWO\nVolumeMode:      Filesystem\nCapacity:        600Gi\nNode Affinity:   <none>\nMessage:         \nSource:\n    Type:          HostPath (bare host directory volume)\n    Path:          /\n    HostPathType:  \nEvents:            <none>\n")),Object(c.b)("p",null,Object(c.b)("a",{parentName:"p",href:"#4.-install-portworx-on-cluster"},"Proceed to step 4")),Object(c.b)("h3",null,"VPC"),Object(c.b)("h4",null,"Provision VPC block storage"),Object(c.b)("p",null,Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/vpc?topic=vpc-infrastructure-cli-plugin-vpc-reference"},"Refer VPC CLI for more details")),Object(c.b)("p",null,"Create 1 VPC block storage volume for each worker (minimum of 3):"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud is volume-create <volume-name> 10iops-tier <vpc zone> --capacity <size>\n")),Object(c.b)("p",null,"For example:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud is volume-create cpd-pwx-vol01 10iops-tier us-east-1 --capacity 200\nibmcloud is volume-create cpd-pwx-vol02 10iops-tier us-east-1 --capacity 200\nibmcloud is volume-create cpd-pwx-vol03 10iops-tier us-east-1 --capacity 200\n")),Object(c.b)("h4",null,"Attach storage to VPC worker nodes"),Object(c.b)("p",null,"Retrieve IAM token, resource group and cluster.  Set environment variables to save typing in later commands."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"IAM_TOKEN=$(ibmcloud iam oauth-tokens --output json | jq -r '.iam_token')\nRESOURCE_GROUP=$(ibmcloud target --output json | jq -r '.resource_group.guid')\nCLUSTER=<clustername>\n")),Object(c.b)("p",null,"List storage volumes:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud is volumes\n")),Object(c.b)("p",null,"Get worker details:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud oc workers --cluster $CLUSTER\n")),Object(c.b)("p",null,"Using the id of the desired worker node and the storage volume, use CLI command to attach:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud ks storage attachment create --cluster $CLUSTER --volume <volume_id> --worker <worker_id>\n")),Object(c.b)("p",null,"For Example:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"ibmcloud ks storage attachment create --cluster $CLUSTER --volume 214099980 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-000001f6\nibmcloud ks storage attachment create --cluster $CLUSTER --volume 214100004 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-00000281\nibmcloud ks storage attachment create --cluster $CLUSTER --volume 214100042 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-00000314 \n")),Object(c.b)("p",null,"Verify attachments:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'curl -X GET "https://containers.cloud.ibm.com/v2/storage/getAttachments?cluster=$CLUSTER&worker=<worker_ID>" --header "X-Auth-Resource-Group-ID: $RESOURCE_GROUP" --header "Authorization: $IAM_TOKEN"\n\ncurl -X GET "https://containers.cloud.ibm.com/v2/storage/getAttachments?cluster=$CLUSTER&worker=kube-bvc11mbw0n2a9mccenlg-timropwxvpc-default-000002a7" --header "X-Auth-Resource-Group-ID: $RESOURCE_GROUP" --header "Authorization: $IAM_TOKEN" {"volume_attachments":[{"id":"0757-1e3db03e-e9bb-44ba-b423-14570a3511e6","volume":{"name":"timro-pwx-vol01","id":"r014-aef666d3-5072-4900-a1b2-23a69cb3f96b"},"device":{"id":"0757-1e3db03e-e9bb-44ba-b423-14570a3511e6-8xbd9"},"name":"volume-attachment","status":"attached","type":"data"},{"id":"0757-6a52d8da-3192-4ac9-b78d-3fa3e402be4f","volume":{"name":"gab-wistful-stimulate-nutmeg","id":"r014-54a8d1d0-b679-4c7e-bec6-b91deb30e98f"},"device":{"id":"0757-6a52d8da-3192-4ac9-b78d-3fa3e402be4f-x5rql"},"name":"volume-attachment","status":"attached","type":"boot"}]}\n')),Object(c.b)("h2",null,"4. Install Portworx on cluster"),Object(c.b)("h3",null,"Create an API Key"),Object(c.b)("p",null,"For reference, full documentation on how to create an API key is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/account?topic=account-userapikey"},"here")),Object(c.b)("p",null,"IMPORTANT: Ensure user creating API Key has sufficient permissions to work with cluster. They must be assigned the ",Object(c.b)("inlineCode",{parentName:"p"},"Editor")," platform role and the ",Object(c.b)("inlineCode",{parentName:"p"},"Manager")," service access role for ",Object(c.b)("inlineCode",{parentName:"p"},"IBM Cloud Kubernetes Service"),". For more information, see ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/containers?topic=containers-access_reference"},"User access permissions"),"."),Object(c.b)("p",null,"NOTE: Portworx won’t install using a service id api key."),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Select “Manage” -> “Access (IAM)” from IBM Cloud Console top menu"),Object(c.b)("li",{parentName:"ul"},"Select “API Keys” -> “Create”"),Object(c.b)("li",{parentName:"ul"},"Save the value of this key")),Object(c.b)("h3",null,"Copy pull secrets"),Object(c.b)("p",null,"Copy from ",Object(c.b)("inlineCode",{parentName:"p"},"default")," namespace to ",Object(c.b)("inlineCode",{parentName:"p"},"kube-system")," and associate with service account  (to use KVDB)"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'oc get secret all-icr-io -n default -o yaml | sed \'s/default/kube-system/g\' | oc create -n kube-system -f -\noc patch -n kube-system serviceaccount/default --type=\'json\' -p=\'[{"op":"add","path":"/imagePullSecrets/-","value":{"name":"all-icr-io"}}]\'\noc describe serviceaccount default -n kube-system\n')),Object(c.b)("h3",null,"Use Public Catalog to install Portworx Enterprise"),Object(c.b)("p",null,"For reference, full documentation on how to install Portworx Enterprise is ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/docs/openshift?topic=openshift-portworx#install_portworx"},"here")),Object(c.b)("p",null,"For non-production scenario, skip encryption. Choose to use in-cluster KVDB for simplicity."),Object(c.b)("p",null,"Open the ",Object(c.b)("a",{parentName:"p",href:"https://cloud.ibm.com/catalog/services/portworx-enterprise"},"Portworx catalog tile"),":"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Select Datacenter"),Object(c.b)("li",{parentName:"ul"},"Choose Pricing plan. For non production scenario, Disaster Recovery isn’t needed"),Object(c.b)("li",{parentName:"ul"},"Enter a service name"),Object(c.b)("li",{parentName:"ul"},"Select resource group"),Object(c.b)("li",{parentName:"ul"},"Provide API key created in step 7 which will produce list of available clusters"),Object(c.b)("li",{parentName:"ul"},"Choose the target cluster"),Object(c.b)("li",{parentName:"ul"},"Under ",Object(c.b)("inlineCode",{parentName:"li"},"tags")," provide the cluster name. Do not provide any other tags."),Object(c.b)("li",{parentName:"ul"},"Enter a Portworx cluster name"),Object(c.b)("li",{parentName:"ul"},"Select “portworx KVDB” in the pulldown for metadata key-value store"),Object(c.b)("li",{parentName:"ul"},"Select “Kubernetes secret” as the secret_type")),Object(c.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(c.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"90.27777777777777%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACW0lEQVQ4y4VU2W7bMBDU//9Pj7RFC/Spz30K7NryLesmRYk6gni6s7IMJYgTAYPlJXJ3ZsigaTzS3MA6j7y0SJJEkMJai6enJwzDoPE9cM3lckEcxwiMMcjSFHXt0DSNxPoG9qcx59y78N5ju90iYKcsS/2pbVudeI2PNqyqStftdrsxw1QyLIpCwT7L5SGMU5bzbAluMB/rum7ccBogDzxt4u7eR65YSd/3eH5+fjF3Pp8RMCvunGWZDrB9Op20/xYoGrnabDaIogh5nt8qXC6XCLIs10kuWq3WOkgsFgus12uEYSgxnLXXOsc1q9XqNsb/Hx8fEZBQ8kXunLTZZ3TuNe4LQpA6VbkoDY5RitzUKKx/Ay1M1ehPLMtdBZmDm5HT/X6PwFYOSSGmtj0a36PtGLsZaKVWhPDq1Y6CiKLdHDJGIQ+HAwLejn/bBOEhRxTnIKeVHFI52oO2kAwkC5ZnDMurdU6jwF7Xtt0ggkqG+8MJn7484OHbD3z++h0/f/1GlJRCgUdWNhptJe28xO6YSjU1UgHn5jBuQLjZjzdlMmrfd+pH+owlTvC+uQnV1OM1Y5ld6xWtzA/DxKEYmT6Kk0IeCasoSpZmxeSVGp3c5UWJwzHGOU6EllT+yRCnBRJBnOSguKoy1TOG18zAN7WePGb1EsZYLbu+XUMRqWkVrmZ1w5jhePIZJ7HOKUrEQiP4FDFz3g716NV341XlhvUNrIA0bbd8HKSkOE5VQZ40njpmxUW0Bdus5N6LxGzJYXTcjaKwXHLGUilM98pn/mqb+xDOJZk/f/f4D1yMXEnOUGhqAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(c.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"portworx options",title:"portworx options",src:"/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/3cbba/portworx_options.png",srcSet:["/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/7fc1e/portworx_options.png 288w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/a5df1/portworx_options.png 576w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/3cbba/portworx_options.png 1152w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/e28d0/portworx_options.png 1308w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    "),Object(c.b)("p",null,"After the service shows as active in the IBM Cloud resource view, verify the deployment:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"kubectl get pods -n kube-system | grep 'portworx\\|stork'\n")),Object(c.b)("p",null,"This should display something like the following:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"portworx-647c5                            1/1     Running     0          9m33s\nportworx-api-h7dnr                        1/1     Running     0          9m33s\nportworx-api-ndpxb                        1/1     Running     0          9m33s\nportworx-api-srnjk                        1/1     Running     0          9m33s\nportworx-gzgqc                            1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-6rnq6   1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-9bfxk   1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-nqqpr   1/1     Running     0          9m33s\nportworx-vxphk                            1/1     Running     0          9m33s\nstork-6f74dcf5fc-mxwxb                    1/1     Running     0          9m33s\nstork-6f74dcf5fc-svnrl                    1/1     Running     0          9m33s\nstork-6f74dcf5fc-z9qlc                    1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-grzr2          1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-nl25m          1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-trhhb          1/1     Running     0          9m33s\n")),Object(c.b)("p",null,"Using one of the portworx pods, check the status of the storage cluster"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"kubectl exec portworx-647c5 -it -n kube-system -- /opt/pwx/bin/pxctl status\n")),Object(c.b)("p",null,"This should produce output like:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"Status: PX is operational\nLicense: PX-Enterprise IBM Cloud (expires in 1201 days)\nNode ID: 5d65ce5b-1333-4b0c-b469-ccf7df1ce94a\n  IP: 172.26.0.10 \n  Local Storage Pool: 1 pool\n  POOL    IO_PRIORITY  RAID_LEVEL  USABLE    USED     STATUS  ZONE      REGION\n  0       LOW          raid0       400 GiB   18 GiB   Online  us-east-1 us-east\n  Local Storage Devices: 1 device\n  Device  Path      Media Type               Size     Last-Scan\n  0:1     /dev/vdd  STORAGE_MEDIUM_MAGNETIC  400 GiB  18 Dec 20 04:43 UTC\n  * Internal kvdb on this node is sharing this storage device /dev/vdd  to store its data.\n  total   -         400 GiB\n  Cache Devices:\n    * No cache devices\nCluster Summary\n  Cluster ID: pwx-iaf\n  Cluster UUID: 45fc03a8-7e82-497d-bc2a-0844dca1459f\n  Scheduler: kubernetes\n  Nodes: 3 node(s) with storage (3 online)\n  IP           ID                                   SchedulerNodeName  StorageNode  Used    Capacity  Status  StorageStatus Version         Kernel                      OS\n  172.26.0.9   f96e278c-fd06-42a8-9684-0d91bc0bde9c 172.26.0.9         Yes          18 GiB  400 GiB   Online  Up            2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  172.26.0.10  5d65ce5b-1333-4b0c-b469-ccf7df1ce94a 172.26.0.10        Yes          18 GiB  400 GiB   Online  Up (This node 2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  172.26.0.11  1b56ec6c-6dcd-4807-a9cd-cf1ae12e7635 172.26.0.11        Yes          18 GiB  400 GiB   Online  Up            2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  Warnings: \n      WARNING: Internal Kvdb is not using dedicated drive on nodes [172.26.0.11 172.26.0.9 172.26.0.10]. This configuration is not recommended for production clusters.\nGlobal Storage Pool\n  Total Used      :  53 GiB\n  Total Capacity  :  1.2 TiB\n")),Object(c.b)("p",null,"To review classificiation:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"kubectl exec -it <portworx_pod> -n kube-system -- /opt/pwx/bin/pxctl cluster provision-status\n")),Object(c.b)("p",null,"Test by creating a PVC - create a yaml file with a read-write-many claim:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"cat <<EOF | oc create -f -\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: mypvc\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 10G\n  storageClassName: portworx-shared-sc\nEOF\n")),Object(c.b)("h2",null,"5. Create Portworx storage class definitions for Cloud Pak for Data"),Object(c.b)("p",null,"Cloud Pak for Data requires certain storage classes. To define them manually, go ",Object(c.b)("a",{parentName:"p",href:"https://www.ibm.com/support/producthub/icpdata/docs/content/SSQNUZ_latest/cpd/install/portworx-storage-classes.html"},"here")," to see the definitions."),Object(c.b)("p",null,"For example ",Object(c.b)("inlineCode",{parentName:"p"},"portworx-shared-gp3")," is defined by:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'cat <<EOF | oc create -f -\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: portworx-shared-gp3\nparameters:\n  priority_io: high\n  repl: "3"\n  sharedv4: "true"\n  io_profile: db_remote\n  disable_io_profile_protection: "1"\nallowVolumeExpansion: true\nprovisioner: kubernetes.io/portworx-volume\nreclaimPolicy: Retain\nvolumeBindingMode: Immediate\nEOF\n')),Object(c.b)("h2",null,"Cleaning up and removing Portworx"),Object(c.b)("p",null,"Run in the cluster:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"curl -fsL https://install.portworx.com/px-wipe | bash\n")),Object(c.b)("p",null,"Remove the resource from the IBM Cloud Console with delete, then deprovision the OpenShift Cluster"))}u.isMDXComponent=!0},BAC9:function(e,t,n){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,n){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},OIbQ:function(e,t,n){e.exports={bxTextTruncateEnd:"last-modified-date-module--bx--text-truncate--end--123zi",bxTextTruncateFront:"last-modified-date-module--bx--text-truncate--front--3xeKz",text:"last-modified-date-module--text--24m-4",row:"last-modified-date-module--row--2BquN"}},QH2O:function(e,t,n){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",darkMode:"PageHeader-module--dark-mode--hBrwL",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}}}]);
//# sourceMappingURL=component---src-pages-install-portworx-for-data-index-mdx-0c7ef7279adf1aa1b0f5.js.map