(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{"5Cs4":function(e,t,o){"use strict";o.r(t),o.d(t,"_frontmatter",(function(){return i})),o.d(t,"default",(function(){return u}));var n,a=o("k1TG"),c=o("8o2o"),r=(o("q1tI"),o("7ljp")),l=o("013z"),i=(o("T0C+"),o("qKvR"),{}),s=(n="PageDescription",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",e)}),b={_frontmatter:i},p=l.a;function u(e){var t=e.components,o=Object(c.a)(e,["components"]);return Object(r.b)(p,Object(a.a)({},b,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)(s,{mdxType:"PageDescription"}),Object(r.b)("h2",null,"The following steps provide a fast path to manually complete the installation based on information from ",Object(r.b)("a",Object(a.a)({parentName:"h2"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-portworx"}),"Storing data with Portworx")),Object(r.b)("p",null,"Ensure you have access to an OpenShift cluster with the correct size and number of workers. Portworx requires workers that are at least 16cpu/64GB."),Object(r.b)("p",null,"For reference, full documentation on how to provision an OpenShift cluster is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-getting-started#clusters_gs"}),"here"),"."),Object(r.b)("h2",null,"1. Log in to IBM Cloud CLI"),Object(r.b)("p",null,"From a terminal window, log in to IBM Cloud using the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.ibm.com/cloud/cli"}),"cli")," and set the target ",Object(r.b)("inlineCode",{parentName:"p"},"resource_group")," to the group with your target OpenShift cluster."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud login -sso\nibmcloud target -r us-south -g <resource_group>\nibmcloud oc clusters\nibmcloud oc cluster config -c <cluster_name> –-admin\n")),Object(r.b)("h2",null,"2. Provision and Attach Block Storage"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#classic-infrastructure"}),"Classic Infrastructure clusters")),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#vpc"}),"VPC clusters")),Object(r.b)("h3",null,"Classic Infrastructure"),Object(r.b)("h4",null,"Provision classic block storage"),Object(r.b)("p",null,"For reference, full documentation on manually provisioning Block Storage is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/containers?topic=containers-utilities#manual_block"}),"here"),"."),Object(r.b)("p",null,"Issue this command for each of the workers:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block volume-order --storage-type endurance --size <size> --tier 10 --os-type LINUX -d <datacenter>\n")),Object(r.b)("p",null,"Get block volume details:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block volume-list\n")),Object(r.b)("p",null,"Get worker details:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud oc workers --cluster $CLUSTER\n")),Object(r.b)("p",null,"For each worker, authorize the block storage:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block access-authorize <volume_id> -p <node_private_ip>\n")),Object(r.b)("p",null,"For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block access-authorize 214099980 -p 10.185.227.240\nibmcloud sl block access-authorize 214100004 -p 10.185.227.238\nibmcloud sl block access-authorize 214100042 -p 10.185.227.242\nibmcloud sl block access-authorize 214100076 -p 10.185.227.248\n")),Object(r.b)("h4",null,"Attach storage to classic worker nodes"),Object(r.b)("p",null,"a. Install or migrate to Helm version 3 on cluster"),Object(r.b)("p",null,"For reference, instructions to install Helm v3 are ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-helm#install_v3"}),"here"),"."),Object(r.b)("p",null,"b. Install IBM Cloud Block Storage Attacher Plug-in"),Object(r.b)("p",null,"For reference, full documentation on IBM Cloud Block Storage Attacher Plug-in is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-utilities#block_storage_attacher"}),"here"),"."),Object(r.b)("p",null,"Issue these commands:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"oc project kube-system\nhelm repo update\nhelm install block-attacher iks-charts/ibm-block-storage-attacher\noc get pod -n kube-system -o wide | grep attacher\noc get storageclasses | grep attacher\n")),Object(r.b)("p",null,"c. Attach newly created block storage to worker nodes"),Object(r.b)("p",null,"For reference, full documentation on how to attach raw block storage to worker nodes is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-utilities#attach_block"}),"here"),"."),Object(r.b)("p",null,"List storage volumes"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block volume-list\n")),Object(r.b)("p",null,"Issue these two commands for each storage volume to get necessary information to create PVs below:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud sl block access-list <volume_id>\nibmcloud sl block volume-detail <volume_id>\n")),Object(r.b)("p",null,"Create a PV to attach each storage block to a worker:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'cat <<EOF | oc create -f -\napiVersion: v1\nkind: PersistentVolume\nmetadata:\nname: <pv_name>\nannotations:\n  ibm.io/iqn: "<IQN_hostname>"\n  ibm.io/username: "<username>"\n  ibm.io/password: "<password>"\n  ibm.io/targetip: "<targetIP>"\n  ibm.io/lunid: "<lunID>"\n  ibm.io/nodeip: "<private_worker_IP>"\n  ibm.io/volID: "<volume_ID>"\nspec:\ncapacity:\n  storage: <size>\naccessModes:\n  - ReadWriteOnce\nhostPath:\n  path: /\nstorageClassName: ibmc-block-attacher\nEOF\n')),Object(r.b)("p",null,"For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'cat <<EOF | oc create -f -\napiVersion: v1\nkind: PersistentVolume\nmetadata:\nname: px-pv-240\nannotations:\n  ibm.io/iqn: "iqn.2021-02.com.ibm:ibm02su2270065-i168011233"\n  ibm.io/username: "IBM02SU2270065-I168011233"\n  ibm.io/password: "xxxxxxxxxxxxx"\n  ibm.io/targetip: "161.26.110.196"\n  ibm.io/lunid: "0"\n  ibm.io/nodeip: "10.185.227.240"\n  ibm.io/volID: "214099980"\nspec:\ncapacity:\n  storage: 600Gi\naccessModes:\n  - ReadWriteOnce\nhostPath:\n  path: /\nstorageClassName: ibmc-block-attacher\nEOF\n')),Object(r.b)("p",null,"To list and describe pv:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"oc get pv\noc describe pv <pv_name>\n")),Object(r.b)("p",null,"If attached correctly, you will see ",Object(r.b)("inlineCode",{parentName:"p"},"ibm.io/attachstatus: attached")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"Name:            px-pv-238\nLabels:          <none>\nAnnotations:     ibm.io/attachstatus: attached\n                 ibm.io/dm: /dev/dm-1\n                 ibm.io/iqn: iqn.2021-02.com.ibm:ibm02su2270065-i168011229\n                 ibm.io/lunid: 1\n                 ibm.io/mpath: 3600a09803830566f4724516532536b52\n                 ibm.io/nodeip: 10.185.227.238\n                 ibm.io/password: eRdwGTYSBbCZh444\n                 ibm.io/targetip: 161.26.110.204\n                 ibm.io/username: IBM02SU2270065-I168011229\n                 ibm.io/volID: 214100004\nFinalizers:      [kubernetes.io/pv-protection]\nStorageClass:    ibmc-block-attacher\nStatus:          Available\nClaim:           \nReclaim Policy:  Retain\nAccess Modes:    RWO\nVolumeMode:      Filesystem\nCapacity:        600Gi\nNode Affinity:   <none>\nMessage:         \nSource:\n    Type:          HostPath (bare host directory volume)\n    Path:          /\n    HostPathType:  \nEvents:            <none>\n")),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"#4.-install-portworx-on-cluster"}),"Proceed to step 4")),Object(r.b)("h3",null,"VPC"),Object(r.b)("h4",null,"Provision VPC block storage"),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/vpc?topic=vpc-infrastructure-cli-plugin-vpc-reference"}),"Refer VPC CLI for more details")),Object(r.b)("p",null,"Create 1 VPC block storage volume for each worker (minimum of 3):"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud is volume-create <volume-name> 10iops-tier <vpc zone> --capacity <size>\n")),Object(r.b)("p",null,"For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud is volume-create cpd-pwx-vol01 10iops-tier us-east-1 --capacity 200\nibmcloud is volume-create cpd-pwx-vol02 10iops-tier us-east-1 --capacity 200\nibmcloud is volume-create cpd-pwx-vol03 10iops-tier us-east-1 --capacity 200\n")),Object(r.b)("h4",null,"Attach storage to VPC worker nodes"),Object(r.b)("p",null,"Retrieve IAM token, resource group and cluster.  Set environment variables to save typing in later commands."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"IAM_TOKEN=$(ibmcloud iam oauth-tokens --output json | jq -r '.iam_token')\nRESOURCE_GROUP=$(ibmcloud target --output json | jq -r '.resource_group.guid')\nCLUSTER=<clustername>\n")),Object(r.b)("p",null,"List storage volumes:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud is volumes\n")),Object(r.b)("p",null,"Get worker details:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud oc workers --cluster $CLUSTER\n")),Object(r.b)("p",null,"Using the id of the desired worker node and the storage volume, use CLI command to attach:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud ks storage attachment create --cluster $CLUSTER --volume <volume_id> --worker <worker_id>\n")),Object(r.b)("p",null,"For Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"ibmcloud ks storage attachment create --cluster $CLUSTER --volume 214099980 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-000001f6\nibmcloud ks storage attachment create --cluster $CLUSTER --volume 214100004 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-00000281\nibmcloud ks storage attachment create --cluster $CLUSTER --volume 214100042 --worker kube-c0mktgsd0b2lo0bik8q0-cp4dpartner-default-00000314 \n")),Object(r.b)("p",null,"Verify attachments:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'curl -X GET "https://containers.cloud.ibm.com/v2/storage/getAttachments?cluster=$CLUSTER&worker=<worker_ID>" --header "X-Auth-Resource-Group-ID: $RESOURCE_GROUP" --header "Authorization: $IAM_TOKEN"\n\ncurl -X GET "https://containers.cloud.ibm.com/v2/storage/getAttachments?cluster=$CLUSTER&worker=kube-bvc11mbw0n2a9mccenlg-timropwxvpc-default-000002a7" --header "X-Auth-Resource-Group-ID: $RESOURCE_GROUP" --header "Authorization: $IAM_TOKEN" {"volume_attachments":[{"id":"0757-1e3db03e-e9bb-44ba-b423-14570a3511e6","volume":{"name":"timro-pwx-vol01","id":"r014-aef666d3-5072-4900-a1b2-23a69cb3f96b"},"device":{"id":"0757-1e3db03e-e9bb-44ba-b423-14570a3511e6-8xbd9"},"name":"volume-attachment","status":"attached","type":"data"},{"id":"0757-6a52d8da-3192-4ac9-b78d-3fa3e402be4f","volume":{"name":"gab-wistful-stimulate-nutmeg","id":"r014-54a8d1d0-b679-4c7e-bec6-b91deb30e98f"},"device":{"id":"0757-6a52d8da-3192-4ac9-b78d-3fa3e402be4f-x5rql"},"name":"volume-attachment","status":"attached","type":"boot"}]}\n')),Object(r.b)("h2",null,"4. Install Portworx on cluster"),Object(r.b)("h3",null,"Create an API Key"),Object(r.b)("p",null,"For reference, full documentation on how to create an API key is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/account?topic=account-userapikey"}),"here")),Object(r.b)("p",null,"IMPORTANT: Ensure user creating API Key has sufficient permissions to work with cluster. They must be assigned the ",Object(r.b)("inlineCode",{parentName:"p"},"Editor")," platform role and the ",Object(r.b)("inlineCode",{parentName:"p"},"Manager")," service access role for ",Object(r.b)("inlineCode",{parentName:"p"},"IBM Cloud Kubernetes Service"),". For more information, see ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/containers?topic=containers-access_reference"}),"User access permissions"),"."),Object(r.b)("p",null,"NOTE: Portworx won’t install using a service id api key."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Select “Manage” -> “Access (IAM)” from IBM Cloud Console top menu"),Object(r.b)("li",{parentName:"ul"},"Select “API Keys” -> “Create”"),Object(r.b)("li",{parentName:"ul"},"Save the value of this key")),Object(r.b)("h3",null,"Copy pull secrets"),Object(r.b)("p",null,"Copy from ",Object(r.b)("inlineCode",{parentName:"p"},"default")," namespace to ",Object(r.b)("inlineCode",{parentName:"p"},"kube-system")," and associate with service account  (to use KVDB)"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'oc get secret all-icr-io -n default -o yaml | sed \'s/default/kube-system/g\' | oc create -n kube-system -f -\noc patch -n kube-system serviceaccount/default --type=\'json\' -p=\'[{"op":"add","path":"/imagePullSecrets/-","value":{"name":"all-icr-io"}}]\'\noc describe serviceaccount default -n kube-system\n')),Object(r.b)("h3",null,"Use Public Catalog to install Portworx Enterprise"),Object(r.b)("p",null,"For reference, full documentation on how to install Portworx Enterprise is ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/docs/openshift?topic=openshift-portworx#install_portworx"}),"here")),Object(r.b)("p",null,"For non-production scenario, skip encryption. Choose to use in-cluster KVDB for simplicity."),Object(r.b)("p",null,"Open the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://cloud.ibm.com/catalog/services/portworx-enterprise"}),"Portworx catalog tile"),":"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Select Datacenter"),Object(r.b)("li",{parentName:"ul"},"Choose Pricing plan. For non production scenario, Disaster Recovery isn’t needed"),Object(r.b)("li",{parentName:"ul"},"Enter a service name"),Object(r.b)("li",{parentName:"ul"},"Select resource group"),Object(r.b)("li",{parentName:"ul"},"Provide API key created in step 7 which will produce list of available clusters"),Object(r.b)("li",{parentName:"ul"},"Choose the target cluster"),Object(r.b)("li",{parentName:"ul"},"Under ",Object(r.b)("inlineCode",{parentName:"li"},"tags")," provide the cluster name. Do not provide any other tags."),Object(r.b)("li",{parentName:"ul"},"Enter a Portworx cluster name"),Object(r.b)("li",{parentName:"ul"},"Select “portworx KVDB” in the pulldown for metadata key-value store"),Object(r.b)("li",{parentName:"ul"},"Select “Kubernetes secret” as the secret_type")),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(r.b)("span",Object(a.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"90.27777777777777%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsSAAALEgHS3X78AAACT0lEQVQ4y42U646bMBCFef/32W7brdQn6N9q70kTyAIGDAYbSKKczhlCmqTbVZE+GV/GHs8cTxRCD1M2aNoepW2QZRnyPEfTNNjv99jtdgr//wXn+RljENV1LT85uraF9x267hLvvbatzH9ECAHr9RoRO9ZaNer7/gIuItz0vzekh7xiWZaoqgrsk/n/2uOZ+aC5TwfiOEY0D47jqC1jN8fkve9wOKgx1zN+5x8dUw+5Mz1kQuh2mqbq4XtwHdesVitdz3BxjPu8vLwgYmexWGC5XOrA09MTHh8f8fDwoP3X19cLOMY58vz8fBqj/f39PSLnnJ5S1xbOiXyaGk6urbhz3LswRITh0qRUor3kTZJiJdtNQCXYpj/Cfo/GBTWuKnvK6DnMA2OaJAmixrXISo+iGdD6AaEf0PmZXvFhkhA3Y0KGYbiAY0zkZiMb2tphEZdYvYl85MXUdSOGImTKQU6evWhVAW6aO8Md22HcIqaHySbFzacvuP18h5vbr7j79h1JWqKoAwrrta3lykVp8SsxcmirGJkz1R9sO2K5SvhSpuBO4gynK1y/mNbROwd/FPUw9Cdot9tujzGUDBlTIDOVFgnCRM3ZI4xdZWskmwxplqMojNrkYkOyvNR5alM9pCgpkyAx01Ov3jJhbE1RSSz99OSUKWltFzSG6iGlECcpNiKdc1J5BSxHhAdORcCdKpLXStQd+1P21+uYV3ZibMBsu9bracT7cIzhcJLMXAT+0qGw3Y7I3uKpfM1X7mViHAeMVzqbN/yIThz48TPBb/8gXLk9ngnOAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(a.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"portworx options",title:"portworx options",src:"/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/3cbba/portworx_options.png",srcSet:["/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/7fc1e/portworx_options.png 288w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/a5df1/portworx_options.png 576w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/3cbba/portworx_options.png 1152w","/ibm-enterprise-runbooks/static/ce3cdd17b957e7c5464c35a0635680af/e28d0/portworx_options.png 1308w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("p",null,"After the service shows as active in the IBM Cloud resource view, verify the deployment:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"kubectl get pods -n kube-system | grep 'portworx\\|stork'\n")),Object(r.b)("p",null,"This should display something like the following:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"portworx-647c5                            1/1     Running     0          9m33s\nportworx-api-h7dnr                        1/1     Running     0          9m33s\nportworx-api-ndpxb                        1/1     Running     0          9m33s\nportworx-api-srnjk                        1/1     Running     0          9m33s\nportworx-gzgqc                            1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-6rnq6   1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-9bfxk   1/1     Running     0          9m33s\nportworx-pvc-controller-b8c88b4d7-nqqpr   1/1     Running     0          9m33s\nportworx-vxphk                            1/1     Running     0          9m33s\nstork-6f74dcf5fc-mxwxb                    1/1     Running     0          9m33s\nstork-6f74dcf5fc-svnrl                    1/1     Running     0          9m33s\nstork-6f74dcf5fc-z9qlc                    1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-grzr2          1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-nl25m          1/1     Running     0          9m33s\nstork-scheduler-7d755b5475-trhhb          1/1     Running     0          9m33s\n")),Object(r.b)("p",null,"Using one of the portworx pods, check the status of the storage cluster"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"kubectl exec portworx-647c5 -it -n kube-system -- /opt/pwx/bin/pxctl status\n")),Object(r.b)("p",null,"This should produce output like:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"Status: PX is operational\nLicense: PX-Enterprise IBM Cloud (expires in 1201 days)\nNode ID: 5d65ce5b-1333-4b0c-b469-ccf7df1ce94a\n  IP: 172.26.0.10 \n  Local Storage Pool: 1 pool\n  POOL    IO_PRIORITY  RAID_LEVEL  USABLE    USED     STATUS  ZONE      REGION\n  0       LOW          raid0       400 GiB   18 GiB   Online  us-east-1 us-east\n  Local Storage Devices: 1 device\n  Device  Path      Media Type               Size     Last-Scan\n  0:1     /dev/vdd  STORAGE_MEDIUM_MAGNETIC  400 GiB  18 Dec 20 04:43 UTC\n  * Internal kvdb on this node is sharing this storage device /dev/vdd  to store its data.\n  total   -         400 GiB\n  Cache Devices:\n    * No cache devices\nCluster Summary\n  Cluster ID: pwx-iaf\n  Cluster UUID: 45fc03a8-7e82-497d-bc2a-0844dca1459f\n  Scheduler: kubernetes\n  Nodes: 3 node(s) with storage (3 online)\n  IP           ID                                   SchedulerNodeName  StorageNode  Used    Capacity  Status  StorageStatus Version         Kernel                      OS\n  172.26.0.9   f96e278c-fd06-42a8-9684-0d91bc0bde9c 172.26.0.9         Yes          18 GiB  400 GiB   Online  Up            2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  172.26.0.10  5d65ce5b-1333-4b0c-b469-ccf7df1ce94a 172.26.0.10        Yes          18 GiB  400 GiB   Online  Up (This node 2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  172.26.0.11  1b56ec6c-6dcd-4807-a9cd-cf1ae12e7635 172.26.0.11        Yes          18 GiB  400 GiB   Online  Up            2.6.1.6-3409af2 3.10.0-1160.6.1.el7.x86_64  Red Hat\n  Warnings: \n      WARNING: Internal Kvdb is not using dedicated drive on nodes [172.26.0.11 172.26.0.9 172.26.0.10]. This configuration is not recommended for production clusters.\nGlobal Storage Pool\n  Total Used      :  53 GiB\n  Total Capacity  :  1.2 TiB\n")),Object(r.b)("p",null,"To review classificiation:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"kubectl exec -it <portworx_pod> -n kube-system -- /opt/pwx/bin/pxctl cluster provision-status\n")),Object(r.b)("p",null,"Test by creating a PVC - create a yaml file with a read-write-many claim:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"cat <<EOF | oc create -f -\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: mypvc\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 10G\n  storageClassName: portworx-shared-sc\nEOF\n")),Object(r.b)("h2",null,"5. Create Portworx storage class definitions for Cloud Pak for Data"),Object(r.b)("p",null,"Cloud Pak for Data requires certain storage classes. To define them manually, go ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.ibm.com/support/producthub/icpdata/docs/content/SSQNUZ_latest/cpd/install/portworx-storage-classes.html"}),"here")," to see the definitions."),Object(r.b)("p",null,"For example ",Object(r.b)("inlineCode",{parentName:"p"},"portworx-shared-gp3")," is defined by:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),'cat <<EOF | oc create -f -\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: portworx-shared-gp3\nparameters:\n  priority_io: high\n  repl: "3"\n  sharedv4: "true"\n  io_profile: db_remote\n  disable_io_profile_protection: "1"\nallowVolumeExpansion: true\nprovisioner: kubernetes.io/portworx-volume\nreclaimPolicy: Retain\nvolumeBindingMode: Immediate\nEOF\n')),Object(r.b)("h2",null,"Cleaning up and removing Portworx"),Object(r.b)("p",null,"Run in the cluster:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"curl -fsL https://install.portworx.com/px-wipe | bash\n")),Object(r.b)("p",null,"Remove the resource from the IBM Cloud Console with delete, then deprovision the OpenShift Cluster"))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-install-portworx-for-data-index-mdx-fac53837621be162109f.js.map